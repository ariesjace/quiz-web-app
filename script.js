let quizzes = {
  quiz1: [
    {q:"Which of the following is the primary purpose of urinalysis?", options:["Diagnose urinary tract infections","Assess renal and metabolic disorders","Monitor hydration status","All of the above"], answer:3},
    {q:"What percentage of laboratory diagnoses are estimated to involve urinalysis?", options:["30%","50%","70%","90%"], answer:2},
    {q:"Which of the following is NOT a function of the kidney?", options:["Regulation of blood pressure","Detoxification of harmful gases","Maintenance of acid-base balance","Excretion of metabolic waste"], answer:1},
    {q:"The nephron is composed of which two main structures?", options:["Glomerulus and tubules","Glomerulus and renal pelvis","Tubules and ureters","Renal artery and vein"], answer:0},
    {q:"How many nephrons are found in each kidney?", options:["About 100,000","About 500,000","About 1 million","About 10 million"], answer:2},
    {q:"Which of the following is considered the functional unit of the kidney?", options:["Nephron","Glomerulus","Bowman’s capsule","Renal pelvis"], answer:0},
    {q:"Which structure collects urine from the nephrons before passing it to the ureter?", options:["Renal cortex","Renal medulla","Renal pelvis","Renal artery"], answer:2},
    {q:"Which part of the nephron is primarily involved in filtration?", options:["Proximal tubule","Loop of Henle","Glomerulus","Collecting duct"], answer:2},
    {q:"The Bowman’s capsule surrounds which structure?", options:["Distal convoluted tubule","Glomerulus","Loop of Henle","Renal pelvis"], answer:1},
    {q:"The primary process occurring in the glomerulus is:", options:["Secretion","Filtration","Reabsorption","Concentration"], answer:1},
    {q:"Which specimen is most commonly used for routine urinalysis?", options:["First morning urine","Random urine","24-hour urine","Catheterized specimen"], answer:1},
    {q:"The ideal specimen for pregnancy testing is:", options:["Random urine","First morning urine","Timed urine","24-hour urine"], answer:1},
    {q:"Which specimen is best for detecting orthostatic proteinuria?", options:["Random urine","Midstream clean-catch","First morning and second specimen comparison","24-hour urine"], answer:2},
    {q:"Which type of urine specimen is most useful for detecting nitrite and leukocyte esterase?", options:["First morning urine","24-hour urine","Random urine","Midstream clean-catch"], answer:3},
    {q:"Which urine collection method minimizes contamination?", options:["Catheterization","Midstream clean-catch","Suprapubic aspiration","All of the above"], answer:3},
    {q:"The best urine specimen for culture and sensitivity testing is:", options:["First morning urine","Random urine","24-hour urine","Midstream clean-catch"], answer:3},
    {q:"Which urine collection method is used for pediatric patients?", options:["First morning urine","Random urine","Urine collection bag","24-hour urine"], answer:2},
    {q:"The 24-hour urine specimen is primarily collected to:", options:["Measure solute excretion","Measure urine pH","Perform routine urinalysis","Detect infection"], answer:0},
    {q:"Which preservative is commonly used in 24-hour urine collection?", options:["Formalin","Toluene","Thymol","All of the above"], answer:3},
    {q:"The volume of urine normally excreted in 24 hours is approximately:", options:["200–500 mL","600–2000 mL","2500–3000 mL","3500–4000 mL"], answer:1},
    {q:"Oliguria refers to urine output less than:", options:["100 mL/day","200 mL/day","400 mL/day","600 mL/day"], answer:2},
    {q:"Anuria is defined as urine output less than:", options:["10 mL/day","50 mL/day","100 mL/day","200 mL/day"], answer:1},
    {q:"Polyuria is usually defined as urine output greater than:", options:["1000 mL/day","1500 mL/day","2000 mL/day","2500 mL/day"], answer:2},
    {q:"Which of the following may cause polyuria?", options:["Diabetes mellitus","Diabetes insipidus","Excessive fluid intake","All of the above"], answer:3},
    {q:"Which condition is associated with oliguria?", options:["Dehydration","Shock","Renal failure","All of the above"], answer:3},
    {q:"Nocturia refers to:", options:["Decreased urine at night","Excessive urination at night","Painful urination","Frequent urination"], answer:1},
    {q:"Which term refers to painful urination?", options:["Nocturia","Dysuria","Polyuria","Oliguria"], answer:1},
    {q:"Which term refers to increased frequency of urination?", options:["Dysuria","Polyuria","Frequency","Nocturia"], answer:2},
    {q:"The presence of visible blood in urine is called:", options:["Hemoglobinuria","Hematuria","Myoglobinuria","Bilirubinuria"], answer:1},
    {q:"Which urine collection method is most sterile?", options:["Midstream clean-catch","Catheterization","Suprapubic aspiration","Random collection"], answer:2},
    {q:"Which urine collection is preferred for cytology studies?", options:["First morning urine","24-hour urine","Random urine","Second morning voided urine"], answer:3},
    {q:"Specimens for routine urinalysis should be examined within:", options:["30 minutes","1 hour","2 hours","4 hours"], answer:1},
    {q:"If a urine specimen cannot be examined promptly, it should be:", options:["Frozen immediately","Preserved with ethanol","Refrigerated","Diluted with saline"], answer:2},
    {q:"Which change may occur in urine left unpreserved at room temperature?", options:["Decreased pH","Decreased bacteria","Increased glucose","Increased nitrite"], answer:3},
    {q:"Which component decreases in unpreserved urine?", options:["Nitrite","pH","Glucose","Bacteria"], answer:2},
    {q:"A urine specimen left standing at room temperature will have:", options:["Increased clarity","Decreased pH","Increased bacteria","Decreased nitrite"], answer:2},
    {q:"Which of the following is a disadvantage of refrigeration as a preservative?", options:["Prevents bacterial growth","Preserves chemical constituents","May cause precipitation of crystals","Prevents decomposition"], answer:2},
    {q:"Which is the most common preservative for urine specimens?", options:["Formalin","Toluene","Refrigeration","Thymol"], answer:2},
    {q:"Which urine specimen is best for detecting metabolic disorders?", options:["First morning urine","Random urine","24-hour urine","Midstream urine"], answer:2},
    {q:"The least desirable urine specimen for routine analysis is:", options:["First morning urine","Random urine","Midstream urine","24-hour urine"], answer:1}
  ],
  quiz2: [
    {
      question: "Placeholder Q1 (Quiz 2)?",
      options: ["A", "B", "C", "D"],
      answer: 2
    },
    {
      question: "Placeholder Q2 (Quiz 2)?",
      options: ["A", "B", "C", "D"],
      answer: 0
    }
  ],
  quiz3: [
    {
      question: "Placeholder Q1 (Quiz 3)?",
      options: ["A", "B", "C", "D"],
      answer: 1
    },
    {
      question: "Placeholder Q2 (Quiz 3)?",
      options: ["A", "B", "C", "D"],
      answer: 3
    }
  ]
};

let currentQuiz = [];
let userAnswers = [];
let currentPage = 0;
const pageSize = 5;

function selectQuiz(key) {
  currentQuiz = quizzes[key];
  userAnswers = new Array(currentQuiz.length).fill(null);
  currentPage = 0;
  document.getElementById("quizSelection").style.display = "none";
  document.getElementById("quizScreen").style.display = "block";
  loadPage();
}

function loadPage() {
  const start = currentPage * pageSize;
  const end = Math.min(start + pageSize, currentQuiz.length);
  const questionsArea = document.getElementById("questionsArea");
  questionsArea.innerHTML = "";
  document.getElementById("progress").innerText =
    `Questions ${start + 1}-${end} of ${currentQuiz.length}`;

  for (let i = start; i < end; i++) {
    const q = currentQuiz[i];
    const div = document.createElement("div");
    div.classList.add("question-block");
    div.innerHTML = `<p><strong>Q${i + 1}:</strong> ${q.question}</p>`;
    q.options.forEach((opt, idx) => {
      const checked = userAnswers[i] === idx ? "checked" : "";
      div.innerHTML += `
        <label class="option">
          <input type="radio" name="q${i}" value="${idx}" ${checked} 
            onchange="userAnswers[${i}] = ${idx}">
          ${opt}
        </label>
      `;
    });
    questionsArea.appendChild(div);
  }
}

function nextPage() {
  if ((currentPage + 1) * pageSize < currentQuiz.length) {
    currentPage++;
    loadPage();
  }
}

function prevPage() {
  if (currentPage > 0) {
    currentPage--;
    loadPage();
  }
}

function finishQuiz() {
  let score = 0;
  let reviewHTML = "";
  currentQuiz.forEach((q, idx) => {
    const userAns = userAnswers[idx];
    if (userAns === q.answer) score++;
    const correct = q.options[q.answer];
    const userText = userAns !== null ? q.options[userAns] : "Not answered";
    const cls = userAns === q.answer ? "correct" : "incorrect";
    reviewHTML += `
      <p><strong>Q${idx + 1}:</strong> ${q.question}<br>
      Your Answer: <span class="${cls}">${userText}</span><br>
      Correct Answer: <span class="correct">${correct}</span></p>
    `;
  });

  document.getElementById("quizScreen").style.display = "none";
  document.getElementById("resultScreen").style.display = "block";
  document.getElementById("score").innerText =
    `You scored ${score} out of ${currentQuiz.length}`;
  document.getElementById("review").innerHTML = reviewHTML;
}

function restartQuiz() {
  document.getElementById("resultScreen").style.display = "none";
  document.getElementById("quizSelection").style.display = "block";
}

function exitQuiz() {
  if (confirm("Are you sure you want to exit? Progress will be lost.")) {
    document.getElementById("quizScreen").style.display = "none";
    document.getElementById("quizSelection").style.display = "block";
  }
}